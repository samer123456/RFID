# تطبيق قراءة الوزن من الميزان الإلكتروني

## نظرة عامة

هذا التطبيق يقرأ الوزن من الميزان الإلكتروني عبر منفذ COM ويحفظ البيانات في قاعدة بيانات SQL Server.

## الميزات الرئيسية

### 1. قراءة الوزن من الميزان
- الاتصال بالميزان عبر منفذ COM
- قراءة الوزن تلقائياً
- عرض الوزن في واجهة المستخدم

### 2. نظام إدارة المستخدمين
- تسجيل الدخول للمستخدمين
- إدارة المستخدمين (للمديرين فقط)
- أنواع مختلفة من المستخدمين (Admin, User)

### 3. حفظ البيانات في قاعدة البيانات
- حفظ الوزن تلقائياً في SQL Server
- تخزين معلومات المستخدم والمدينة
- سجل كامل لجميع القراءات

### 4. عرض سجل الأوزان
- نافذة منفصلة لعرض السجل
- تصفية حسب التاريخ
- إمكانية حذف السجلات

### 5. إعدادات قابلة للتخصيص
- إعدادات الاتصال بقاعدة البيانات
- خيارات الحفظ التلقائي
- إعدادات السجل

## المتطلبات

### البرامج المطلوبة
- Visual Studio 2019 أو أحدث
- .NET Framework 4.7.2
- SQL Server (Express أو أحدث)
- SQL Server Management Studio (SSMS)

### المكتبات المطلوبة
- System.Data.SqlClient
- Newtonsoft.Json

## التثبيت والإعداد

### 1. تثبيت قاعدة البيانات
راجع ملف `Database_Setup.md` للحصول على تعليمات مفصلة حول:
- تثبيت SQL Server
- إنشاء قاعدة البيانات
- إعداد المستخدمين والصلاحيات

### 2. إعداد التطبيق
1. افتح المشروع في Visual Studio
2. تأكد من تثبيت جميع المكتبات المطلوبة
3. عدّل إعدادات قاعدة البيانات في `DatabaseSettings.cs`
4. ابدأ التطبيق

### 3. إعداد الميزان
1. تأكد من توصيل الميزان بالكمبيوتر
2. حدد منفذ COM الصحيح
3. اضبط إعدادات الاتصال (Baud Rate, Parity, etc.)

## كيفية الاستخدام

### 1. تسجيل الدخول
- شغل التطبيق
- سجل دخولك باستخدام اسم المستخدم وكلمة المرور

### 2. قراءة الوزن
- اضغط على زر "Open Port" لفتح الاتصال
- سيتم قراءة الوزن تلقائياً
- سيتم حفظ الوزن في قاعدة البيانات

### 3. عرض السجل
- اضغط على زر "سجل الأوزان"
- استخدم خيارات التصفية حسب التاريخ
- يمكنك حذف السجلات غير المرغوب فيها

### 4. إدارة المستخدمين (للمديرين)
- اضغط على زر "إدارة المستخدمين"
- أضف أو عدّل أو احذف المستخدمين

## هيكل قاعدة البيانات

### جدول Weights
```sql
CREATE TABLE Weights (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    Weight DECIMAL(10,3) NOT NULL,
    WeightUnit NVARCHAR(10) DEFAULT 'KG',
    ReadingTime DATETIME DEFAULT GETDATE(),
    UserId NVARCHAR(50),
    UserName NVARCHAR(100),
    City NVARCHAR(100),
    Notes NVARCHAR(500)
);
```

## الملفات الرئيسية

- `Form1.cs` - النموذج الرئيسي للتطبيق
- `DatabaseManager.cs` - إدارة قاعدة البيانات
- `DatabaseSettings.cs` - إعدادات قاعدة البيانات
- `WeightHistoryForm.cs` - نافذة سجل الأوزان
- `UserManagementForm.cs` - إدارة المستخدمين
- `LoginForm.cs` - نافذة تسجيل الدخول

## استكشاف الأخطاء

### مشاكل الاتصال بالميزان
- تأكد من توصيل الميزان بشكل صحيح
- تحقق من إعدادات منفذ COM
- تأكد من تشغيل برنامج تشغيل الميزان

### مشاكل قاعدة البيانات
- تأكد من تشغيل SQL Server
- تحقق من إعدادات الاتصال
- تأكد من وجود الصلاحيات المطلوبة

### مشاكل في حفظ البيانات
- تحقق من إعدادات الحفظ التلقائي
- تأكد من صحة تنسيق البيانات
- راجع سجلات الأخطاء

## الأمان

- استخدم كلمات مرور قوية
- احتفظ بنسخ احتياطية من قاعدة البيانات
- راقب سجلات الوصول
- حدث التطبيق بانتظام

## الدعم

للمساعدة أو الإبلاغ عن مشاكل:
1. راجع ملف `Database_Setup.md`
2. تحقق من سجلات الأخطاء
3. تأكد من إعدادات النظام

## الترخيص

هذا المشروع مفتوح المصدر ومتاح للاستخدام الشخصي والتجاري. 